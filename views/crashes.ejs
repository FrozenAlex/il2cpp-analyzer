<html>
<head>
<style>
html {
    background-color: #0d1117;
}

.main {
    display: grid;
    grid-template-rows: 1fr;
    height: 100%;
}

a {
    text-decoration: none;
    display: flex;
}

a, ol {
    color: #ffa657;
}

a:hover {
    color: #cf8647;
}

.coloumn {
    margin: 0 8 0 0;
}

.crashId {
    width: 72px;
}

.date {
    width: 172px;
}

.userId {
    width: auto;
}

</style>
</head>
<body>
    <div class="main">
        <ol id="crashes"></ol>
    </div>
</body>
<script>
    const ul = document.getElementById("crashes");
    const addCrash = (crash) => {
        const li = document.createElement("li");
        const a = document.createElement("a");
        a.setAttribute("href", "/crashes/" + crash.crashId);
        const crashId = document.createElement("div");
        crashId.classList.add("coloumn");
        crashId.classList.add("crashId");
        crashId.innerText = crash.crashId;
        const date = document.createElement("div");
        date.classList.add("coloumn");
        date.classList.add("date");
        date.innerText = new Date(crash.uploadDate).toLocaleString();
        const userId = document.createElement("div");
        userId.classList.add("coloumn");
        userId.classList.add("userId");
        userId.innerText = crash.userId;
        a.appendChild(crashId);
        a.appendChild(date);
        a.appendChild(userId);
        li.appendChild(a);
        ul.appendChild(li);
    }
    const fetchCrashes = async () => {
        try {
            ul.innerHTML = "";
            fetch("/api/crashes?limit=200")
            .then(response => response.json())
            .then(crashes => {
                crashes.forEach(crash => addCrash(crash));
            });
        } catch(err) {
            console.error("Error: " + err);
        }
    }
    fetchCrashes();
    setInterval(fetchCrashes, 60 * 1000);
</script>
</html>